<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è‹¹æœå…¬å¸è‚¡ä»·æ´å¯ŸæŠ¥å‘Š (AAPL 100å¤©)</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/moment@2.29.4/moment.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-moment@1.0.1/dist/chartjs-adapter-moment.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation@latest/dist/chartjs-plugin-annotation.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Helvetica', 'Arial', sans-serif;
        }

        body {
            background-color: #f8fafc;
            color: #334155;
            line-height: 1.6;
            padding: 20px;
            max-width: 1400px;
            margin: 0 auto;
        }

        .container {
            display: flex;
            flex-direction: column;
            gap: 30px;
        }

        header {
            text-align: center;
            padding: 30px 0;
            border-bottom: 1px solid #e2e8f0;
            margin-bottom: 20px;
        }

        h1 {
            color: #1e293b;
            font-size: 2.2rem;
            margin-bottom: 10px;
        }

        .subtitle {
            color: #64748b;
            font-size: 1.1rem;
        }

        .section {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }

        .section-title {
            font-size: 1.5rem;
            color: #1e293b;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #3b82f6;
        }

        .cards-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 15px;
        }

        .card {
            background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%);
            border-radius: 10px;
            padding: 20px;
            transition: transform 0.2s;
        }

        .card:hover {
            transform: translateY(-5px);
        }

        .card-title {
            font-size: 0.9rem;
            color: #64748b;
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .card-value {
            font-size: 1.8rem;
            font-weight: bold;
            color: #1e293b;
            margin-bottom: 5px;
        }

        .card-desc {
            font-size: 0.9rem;
            color: #64748b;
        }

        .positive {
            color: #10b981;
        }

        .negative {
            color: #ef4444;
        }

        .chart-container {
            height: 400px;
            margin-top: 20px;
            position: relative;
        }

        .two-columns {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }

        @media (max-width: 768px) {
            .two-columns {
                grid-template-columns: 1fr;
            }
        }

        .analysis-text {
            margin-bottom: 15px;
            line-height: 1.7;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }

        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #e2e8f0;
        }

        th {
            background-color: #f8fafc;
            font-weight: 600;
            color: #475569;
        }

        tr:nth-child(even) {
            background-color: #f8fafc;
        }

        .summary-box {
            background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%);
            border-left: 4px solid #3b82f6;
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
        }

        .summary-title {
            font-size: 1.2rem;
            color: #1e40af;
            margin-bottom: 15px;
        }

        .insights-list {
            list-style-type: none;
            padding-left: 0;
        }

        .insights-list li {
            padding: 8px 0;
            border-bottom: 1px solid #93c5fd;
        }

        .insights-list li:last-child {
            border-bottom: none;
        }

        footer {
            text-align: center;
            padding: 30px 0;
            color: #64748b;
            font-size: 0.9rem;
            border-top: 1px solid #e2e8f0;
            margin-top: 30px;
        }

        .highlight {
            background-color: #fef3c7;
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: 500;
        }

        .card-row {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin-bottom: 20px;
        }

        .row-title {
            font-size: 1.1rem;
            color: #475569;
            font-weight: 600;
        }

        .chart-wrapper {
            margin-bottom: 40px;
        }

        .chart-title {
            font-size: 1.2rem;
            color: #475569;
            margin-bottom: 15px;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸ è‹¹æœå…¬å¸è‚¡ä»·æ´å¯ŸæŠ¥å‘Š</h1>
            <p class="subtitle">åŸºäº AAPL 100ä¸ªäº¤æ˜“æ—¥æ•°æ® (2025-10-03 è‡³ 2026-02-26)</p>
        </header>

        <!-- ç¬¬ä¸€éƒ¨åˆ†ï¼šå…³é”®æŒ‡æ ‡å¡ç‰‡ -->
        <section class="section">
            <h2 class="section-title">ğŸ“Š å…³é”®æŒ‡æ ‡æ¦‚è§ˆ</h2>

            <div class="card-row">
                <div class="row-title">åŸºç¡€æŒ‡æ ‡</div>
                <div class="cards-grid">
                    <div class="card">
                        <div class="card-title">æ€»äº¤æ˜“å¤©æ•°</div>
                        <div class="card-value" id="total-days">100</div>
                        <div class="card-desc">100ä¸ªäº¤æ˜“æ—¥æ•°æ®</div>
                    </div>

                    <div class="card">
                        <div class="card-title">æ—¥æœŸèŒƒå›´</div>
                        <div class="card-value" id="date-range">2025-10-03 è‡³ 2026-02-26</div>
                        <div class="card-desc">æ•°æ®è¦†ç›–æ—¶æ®µ</div>
                    </div>

                    <div class="card">
                        <div class="card-title">YTD æ”¶ç›Šç‡</div>
                        <div class="card-value positive" id="ytd-return">+5.79%</div>
                        <div class="card-desc">åŸºäºé¦–æ—¥æ”¶ç›˜ä»·è®¡ç®—</div>
                    </div>

                    <div class="card">
                        <div class="card-title">æ—¥å‡æˆäº¤é‡</div>
                        <div class="card-value" id="avg-volume">47,564,438</div>
                        <div class="card-desc">å¹³å‡æ¯æ—¥æˆäº¤é‡</div>
                    </div>
                </div>
            </div>

            <div class="card-row">
                <div class="row-title">ä»·æ ¼æ³¢åŠ¨æŒ‡æ ‡</div>
                <div class="cards-grid">
                    <div class="card">
                        <div class="card-title">åŒºé—´æœ€é«˜ä»·</div>
                        <div class="card-value positive" id="max-price">$288.62</div>
                        <div class="card-desc">(2025-12-03)</div>
                    </div>

                    <div class="card">
                        <div class="card-title">åŒºé—´æœ€ä½ä»·</div>
                        <div class="card-value negative" id="min-price">$243.42</div>
                        <div class="card-desc">(2026-01-20)</div>
                    </div>

                    <div class="card">
                        <div class="card-title">å¹³å‡æ—¥å†…æŒ¯å¹…</div>
                        <div class="card-value" id="avg-daily-range">1.97%</div>
                        <div class="card-desc">æ—¥å‡(High-Low)/Close</div>
                    </div>

                    <div class="card">
                        <div class="card-title">æ¶¨è·Œå¤©æ•°</div>
                        <div class="card-value" id="up-down-days">52â†‘ / 48â†“</div>
                        <div class="card-desc">ä¸Šæ¶¨/ä¸‹è·Œå¤©æ•°</div>
                    </div>
                </div>
            </div>
        </section>

        <!-- ç¬¬äºŒéƒ¨åˆ†ï¼šå›¾è¡¨åŒº -->
        <section class="section">
            <h2 class="section-title">ğŸ“ˆ ä»·æ ¼ä¸æˆäº¤é‡åˆ†æ</h2>

            <div class="chart-wrapper">
                <h3 class="chart-title">1. ä»·æ ¼èµ°åŠ¿ + ç§»åŠ¨å¹³å‡çº¿ (MA5, MA20)</h3>
                <div class="chart-container">
                    <canvas id="priceChart"></canvas>
                </div>
            </div>

            <div class="chart-wrapper">
                <h3 class="chart-title">2. æˆäº¤é‡æŸ±çŠ¶å›¾ (ç»¿è‰²:ä¸Šæ¶¨æ—¥, çº¢è‰²:ä¸‹è·Œæ—¥)</h3>
                <div class="chart-container">
                    <canvas id="volumeChart"></canvas>
                </div>
            </div>

            <div class="two-columns">
                <div class="chart-wrapper">
                    <h3 class="chart-title">3. æ”¶ç›˜ä»·åˆ†å¸ƒç›´æ–¹å›¾</h3>
                    <div class="chart-container">
                        <canvas id="closeHistogram"></canvas>
                    </div>
                </div>
                <div class="chart-wrapper">
                    <h3 class="chart-title">4. æ—¥å†…æ³¢åŠ¨åˆ†æ</h3>
                    <div class="chart-container">
                        <canvas id="rangeChart"></canvas>
                    </div>
                </div>
            </div>
        </section>

        <!-- ç¬¬ä¸‰éƒ¨åˆ†ï¼šæ•°æ®æ·±åº¦åˆ†æ -->
        <section class="section">
            <h2 class="section-title">ğŸ” æ•°æ®æ·±åº¦åˆ†æ</h2>

            <div class="two-columns">
                <div>
                    <h3 style="margin-bottom: 15px; color: #475569;">è¶‹åŠ¿åˆ†æ</h3>
                    <p class="analysis-text">
                        æ•´ä½“è¶‹åŠ¿: <span class="highlight" id="overall-trend">ä¸Šæ¶¨</span><br>
                        ä»·æ ¼ä» <span id="first-close">$258.02</span> ä¸Šæ¶¨è‡³ <span id="last-close">$272.95</span>ï¼Œ
                        ç´¯è®¡æ¶¨å¹… <span class="positive" id="total-change">+5.79%</span>ã€‚
                    </p>
                    <p class="analysis-text">
                        æœ€è¿‘10ä¸ªäº¤æ˜“æ—¥æ¶¨è·Œå¹…: <span class="positive" id="last10-change">+4.29%</span><br>
                        å‰10ä¸ªäº¤æ˜“æ—¥æ¶¨è·Œå¹…: <span class="negative" id="first10-change">-4.10%</span>
                    </p>
                    <p class="analysis-text">
                        æ˜¾ç¤ºè¿‘æœŸè¶‹åŠ¿å‘å¥½ï¼ŒçŸ­æœŸåŠ¨èƒ½è¾ƒå¼ºã€‚
                    </p>
                </div>
                <div>
                    <h3 style="margin-bottom: 15px; color: #475569;">æˆäº¤é‡æ´å¯Ÿ</h3>
                    <p class="analysis-text">
                        æ—¥å‡æˆäº¤é‡: <span id="avg-volume-text">47,564,438</span><br>
                        æˆäº¤é‡æœ€å¤§çš„3ä¸ªäº¤æ˜“æ—¥:
                    </p>
                    <table>
                        <thead>
                            <tr>
                                <th>æ—¥æœŸ</th>
                                <th>æˆäº¤é‡</th>
                                <th>æ¶¨è·Œå¹…</th>
                            </tr>
                        </thead>
                        <tbody id="volume-top3">
                            <!-- è¡¨æ ¼å†…å®¹å°†ç”±JavaScriptå¡«å…… -->
                        </tbody>
                    </table>
                </div>
            </div>

            <div style="margin-top: 25px;">
                <h3 style="margin-bottom: 15px; color: #475569;">æ”¯æ’‘ä¸é˜»åŠ›åˆ†æ</h3>
                <div class="two-columns">
                    <div>
                        <p class="analysis-text"><strong>è¿‘æœŸæ”¯æ’‘ä½:</strong></p>
                        <ul id="support-levels" class="insights-list">
                            <!-- æ”¯æ’‘ä½å°†ç”±JavaScriptå¡«å…… -->
                        </ul>
                    </div>
                    <div>
                        <p class="analysis-text"><strong>è¿‘æœŸé˜»åŠ›ä½:</strong></p>
                        <ul id="resistance-levels" class="insights-list">
                            <!-- é˜»åŠ›ä½å°†ç”±JavaScriptå¡«å…… -->
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- ç¬¬å››éƒ¨åˆ†ï¼šæ€»ç»“ä¸è§‚ç‚¹ -->
        <section class="section">
            <h2 class="section-title">ğŸ’¡ æ€»ç»“ä¸æŠ•èµ„å»ºè®®</h2>

            <div class="summary-box">
                <h3 class="summary-title">æ ¸å¿ƒè§‚å¯Ÿ</h3>
                <ul class="insights-list">
                    <li><strong>è¶‹åŠ¿å‘å¥½:</strong> æ•´ä½“å‘ˆç°ä¸Šæ¶¨è¶‹åŠ¿ï¼ŒYTDæ”¶ç›Šç‡ä¸º+5.79%ï¼Œä¸”è¿‘æœŸ10ä¸ªäº¤æ˜“æ—¥è¡¨ç°(+4.29%)ä¼˜äºå‰æœŸ(-4.10%)ã€‚</li>
                    <li><strong>æ³¢åŠ¨åˆç†:</strong> å¹³å‡æ—¥å†…æŒ¯å¹…1.97%ï¼Œå±äºæ­£å¸¸æ³¢åŠ¨èŒƒå›´ï¼Œæœ€å¤§æ—¥å†…æ³¢åŠ¨å‡ºç°åœ¨2026-02-12(æŒ¯å¹…$15.54)ã€‚</li>
                    <li><strong>é‡ä»·é…åˆ:</strong> æˆäº¤é‡æœ€å¤§çš„äº¤æ˜“æ—¥å¤šä¼´éšä»·æ ¼ä¸Šæ¶¨ï¼Œæ˜¾ç¤ºä¹°ç›˜åŠ›é‡è¾ƒå¼ºã€‚</li>
                </ul>
            </div>

            <div style="margin-top: 25px;">
                <h3 style="color: #475569; margin-bottom: 15px;">æŠ•èµ„å»ºè®®</h3>
                <p class="analysis-text">
                    åŸºäºæŠ€æœ¯åˆ†æï¼Œè‹¹æœè‚¡ä»·ç›®å‰å¤„äºä¸Šå‡é€šé“ä¸­ï¼ŒçŸ­æœŸå‡çº¿(MA5)ä¸Šç©¿é•¿æœŸå‡çº¿(MA20)ï¼Œ
                    æ˜¾ç¤ºçŸ­æœŸåŠ¨èƒ½è¾ƒå¼ºã€‚å»ºè®®å…³æ³¨<span class="highlight">$280</span>é™„è¿‘çš„é˜»åŠ›ä½çªç ´æƒ…å†µï¼Œ
                    è‹¥æ”¾é‡çªç ´åˆ™æœ‰æœ›è¿›ä¸€æ­¥ä¸Šæ¶¨ã€‚ä¸‹æ–¹æ”¯æ’‘ä½åœ¨<span class="highlight">$252-$255</span>åŒºé—´ï¼Œ
                    å¯ä½œä¸ºé£é™©æ§åˆ¶å‚è€ƒã€‚
                </p>
                <p class="analysis-text" style="margin-top: 15px; font-style: italic;">
                    æ³¨ï¼šæœ¬æŠ¥å‘ŠåŸºäºå†å²æ•°æ®æŠ€æœ¯åˆ†æï¼Œä¸æ„æˆæŠ•èµ„å»ºè®®ã€‚å¸‚åœºæœ‰é£é™©ï¼ŒæŠ•èµ„éœ€è°¨æ…ã€‚
                </p>
            </div>
        </section>

        <footer>
            <p>æŠ¥å‘Šç”Ÿæˆæ—¶é—´: <span id="report-time">2026-02-28</span> | æ•°æ®æ¥æº: AAPL_100DAYS.CSV</p>
            <p>Â© 2026 è‚¡ä»·åˆ†ææŠ¥å‘Š | åŒå‡»æ­¤HTMLæ–‡ä»¶å³å¯æŸ¥çœ‹å®Œæ•´æŠ¥å‘Š</p>
        </footer>
    </div>

    <!-- å†…åµŒæ•°æ® -->
    <script>
        // ä»Pythonè„šæœ¬ç”Ÿæˆçš„JSONæ•°æ®
        const metrics = {
            "total_days": 100,
            "date_range_start": "2025-10-03",
            "date_range_end": "2026-02-26",
            "ytd_return": 5.79,
            "avg_volume": 47564438,
            "max_price": 288.62,
            "max_price_date": "2025-12-03",
            "min_price": 243.42,
            "min_price_date": "2026-01-20",
            "avg_daily_range": 1.97,
            "up_days": 52,
            "down_days": 48,
            "trend": "ä¸Šæ¶¨",
            "last_10_return": 4.29,
            "first_10_return": -4.1,
            "recent_lows": [
                252.18,
                254.41,
                255.45
            ],
            "recent_highs": [
                280.9,
                280.18,
                279.5
            ],
            "volume_top3": [
                {
                    "Date": "2025-12-19",
                    "Volume": 144632048,
                    "Close": 273.67,
                    "Open": 272.145,
                    "ChangePct": 0.5603630417608386
                },
                {
                    "Date": "2026-01-30",
                    "Volume": 92443408,
                    "Close": 259.48,
                    "Open": 255.165,
                    "ChangePct": 1.6910626457390419
                },
                {
                    "Date": "2026-02-04",
                    "Volume": 90545710,
                    "Close": 276.49,
                    "Open": 272.285,
                    "ChangePct": 1.544337734359213
                }
            ],
            "high_range_days": [
                {
                    "Date": "2026-02-12",
                    "IntradayRange": 15.54000000000002,
                    "Close": 261.73
                },
                {
                    "Date": "2025-10-10",
                    "IntradayRange": 12.379999999999995,
                    "Close": 245.27
                },
                {
                    "Date": "2026-01-20",
                    "IntradayRange": 11.370000000000005,
                    "Close": 246.7
                },
                {
                    "Date": "2026-02-02",
                    "IntradayRange": 11.285000000000025,
                    "Close": 270.01
                },
                {
                    "Date": "2026-02-17",
                    "IntradayRange": 10.750000000000028,
                    "Close": 263.88
                }
            ],
            "chart_data": {
                "dates": [
                    "2025-10-03",
                    "2025-10-06",
                    "2025-10-07",
                    "2025-10-08",
                    "2025-10-09",
                    "2025-10-10",
                    "2025-10-13",
                    "2025-10-14",
                    "2025-10-15",
                    "2025-10-16",
                    "2025-10-17",
                    "2025-10-20",
                    "2025-10-21",
                    "2025-10-22",
                    "2025-10-23",
                    "2025-10-24",
                    "2025-10-27",
                    "2025-10-28",
                    "2025-10-29",
                    "2025-10-30",
                    "2025-10-31",
                    "2025-11-03",
                    "2025-11-04",
                    "2025-11-05",
                    "2025-11-06",
                    "2025-11-07",
                    "2025-11-10",
                    "2025-11-11",
                    "2025-11-12",
                    "2025-11-13",
                    "2025-11-14",
                    "2025-11-17",
                    "2025-11-18",
                    "2025-11-19",
                    "2025-11-20",
                    "2025-11-21",
                    "2025-11-24",
                    "2025-11-25",
                    "2025-11-26",
                    "2025-11-28",
                    "2025-12-01",
                    "2025-12-02",
                    "2025-12-03",
                    "2025-12-04",
                    "2025-12-05",
                    "2025-12-08",
                    "2025-12-09",
                    "2025-12-10",
                    "2025-12-11",
                    "2025-12-12",
                    "2025-12-15",
                    "2025-12-16",
                    "2025-12-17",
                    "2025-12-18",
                    "2025-12-19",
                    "2025-12-22",
                    "2025-12-23",
                    "2025-12-24",
                    "2025-12-26",
                    "2025-12-29",
                    "2025-12-30",
                    "2025-12-31",
                    "2026-01-02",
                    "2026-01-05",
                    "2026-01-06",
                    "2026-01-07",
                    "2026-01-08",
                    "2026-01-09",
                    "2026-01-12",
                    "2026-01-13",
                    "2026-01-14",
                    "2026-01-15",
                    "2026-01-16",
                    "2026-01-20",
                    "2026-01-21",
                    "2026-01-22",
                    "2026-01-23",
                    "2026-01-26",
                    "2026-01-27",
                    "2026-01-28",
                    "2026-01-29",
                    "2026-01-30",
                    "2026-02-02",
                    "2026-02-03",
                    "2026-02-04",
                    "2026-02-05",
                    "2026-02-06",
                    "2026-02-09",
                    "2026-02-10",
                    "2026-02-11",
                    "2026-02-12",
                    "2026-02-13",
                    "2026-02-17",
                    "2026-02-18",
                    "2026-02-19",
                    "2026-02-20",
                    "2026-02-23",
                    "2026-02-24",
                    "2026-02-25",
                    "2026-02-26"
                ],
                "opens": [
                    254.665,
                    257.99,
                    256.805,
                    256.52,
                    257.805,
                    254.94,
                    249.38,
                    246.6,
                    249.485,
                    248.25,
                    248.02,
                    255.885,
                    261.88,
                    262.65,
                    259.94,
                    261.19,
                    264.88,
                    268.985,
                    269.275,
                    271.99,
                    276.99,
                    270.42,
                    268.325,
                    268.61,
                    267.89,
                    269.795,
                    268.96,
                    269.81,
                    275.0,
                    274.11,
                    271.05,
                    268.815,
                    269.99,
                    265.525,
                    270.83,
                    265.95,
                    270.9,
                    275.27,
                    276.96,
                    277.26,
                    278.01,
                    283.0,
                    286.2,
                    284.095,
                    280.54,
                    278.13,
                    278.16,
                    277.75,
                    279.095,
                    277.9,
                    280.15,
                    272.82,
                    275.01,
                    273.605,
                    272.145,
                    272.86,
                    270.84,
                    272.34,
                    274.16,
                    272.69,
                    272.81,
                    273.06,
                    272.255,
                    270.64,
                    267.0,
                    263.2,
                    257.02,
                    259.075,
                    259.16,
                    258.72,
                    259.49,
                    260.65,
                    257.9,
                    252.73,
                    248.7,
                    249.2,
                    247.32,
                    251.48,
                    259.17,
                    257.65,
                    258.0,
                    255.165,
                    260.03,
                    269.2,
                    272.285,
                    278.13,
                    277.12,
                    277.905,
                    274.885,
                    274.695,
                    275.59,
                    262.01,
                    258.05,
                    263.6,
                    262.6,
                    258.97,
                    263.49,
                    267.86,
                    271.78,
                    274.945
                ],
                "highs": [
                    259.24,
                    259.07,
                    257.4,
                    258.52,
                    258.0,
                    256.38,
                    249.69,
                    248.845,
                    251.82,
                    249.04,
                    253.38,
                    264.375,
                    265.29,
                    262.85,
                    260.62,
                    264.13,
                    269.12,
                    269.89,
                    271.41,
                    274.14,
                    277.32,
                    270.85,
                    271.486,
                    271.7,
                    273.4,
                    272.29,
                    273.73,
                    275.91,
                    275.73,
                    276.699,
                    275.96,
                    270.49,
                    270.71,
                    272.21,
                    275.43,
                    273.33,
                    277.0,
                    280.38,
                    279.53,
                    279.0,
                    283.42,
                    287.4,
                    288.62,
                    284.73,
                    281.14,
                    279.6693,
                    280.03,
                    279.75,
                    279.59,
                    279.22,
                    280.15,
                    275.5,
                    276.16,
                    273.63,
                    274.6,
                    273.88,
                    272.5,
                    275.43,
                    275.37,
                    274.36,
                    274.08,
                    273.68,
                    277.84,
                    271.51,
                    267.55,
                    263.68,
                    259.29,
                    260.21,
                    261.3,
                    261.81,
                    261.04,
                    258.9,
                    254.79,
                    251.56,
                    251.0,
                    249.41,
                    256.56,
                    261.95,
                    258.855,
                    259.65,
                    261.8999,
                    270.49,
                    271.875,
                    278.95,
                    279.5,
                    280.905,
                    278.2,
                    275.37,
                    280.18,
                    275.72,
                    262.23,
                    266.29,
                    266.82,
                    264.48,
                    264.75,
                    269.43,
                    274.89,
                    274.94,
                    276.11
                ],
                "lows": [
                    253.95,
                    255.05,
                    255.43,
                    256.11,
                    253.14,
                    244.0,
                    245.56,
                    244.7,
                    247.47,
                    245.13,
                    247.27,
                    255.63,
                    261.83,
                    255.43,
                    258.0101,
                    259.18,
                    264.6501,
                    268.15,
                    267.11,
                    268.48,
                    269.16,
                    266.25,
                    267.615,
                    266.93,
                    267.89,
                    266.77,
                    267.455,
                    269.8,
                    271.7,
                    272.09,
                    269.6,
                    265.73,
                    265.32,
                    265.5,
                    265.92,
                    265.67,
                    270.9,
                    275.25,
                    276.63,
                    275.9865,
                    276.14,
                    282.6301,
                    283.3,
                    278.59,
                    278.05,
                    276.15,
                    276.92,
                    276.44,
                    273.81,
                    276.82,
                    272.84,
                    271.79,
                    271.64,
                    266.95,
                    269.9,
                    270.505,
                    269.56,
                    272.195,
                    272.86,
                    272.35,
                    272.28,
                    271.75,
                    269.0,
                    266.14,
                    262.12,
                    259.81,
                    255.7,
                    256.22,
                    256.8,
                    258.39,
                    256.71,
                    257.05,
                    254.93,
                    243.42,
                    245.18,
                    248.15,
                    244.68,
                    249.8,
                    258.21,
                    254.51,
                    254.41,
                    252.18,
                    259.205,
                    267.61,
                    272.285,
                    273.23,
                    276.925,
                    271.7,
                    272.94,
                    274.45,
                    260.18,
                    255.45,
                    255.54,
                    262.45,
                    260.05,
                    258.16,
                    263.381,
                    267.71,
                    271.05,
                    270.795
                ],
                "closes": [
                    258.02,
                    256.69,
                    256.48,
                    258.06,
                    254.04,
                    245.27,
                    247.66,
                    247.77,
                    249.34,
                    247.45,
                    252.29,
                    262.24,
                    262.77,
                    258.45,
                    259.58,
                    262.82,
                    268.81,
                    269.0,
                    269.7,
                    271.4,
                    270.37,
                    269.05,
                    270.04,
                    270.14,
                    269.77,
                    268.47,
                    269.43,
                    275.25,
                    273.47,
                    272.95,
                    272.41,
                    267.46,
                    267.44,
                    268.56,
                    266.25,
                    271.49,
                    275.92,
                    276.97,
                    277.55,
                    278.85,
                    283.1,
                    286.19,
                    284.15,
                    280.7,
                    278.78,
                    277.89,
                    277.18,
                    278.78,
                    278.03,
                    278.28,
                    274.11,
                    274.61,
                    271.84,
                    272.19,
                    273.67,
                    270.97,
                    272.36,
                    273.81,
                    273.4,
                    273.76,
                    273.08,
                    271.86,
                    271.01,
                    267.26,
                    262.36,
                    260.33,
                    259.04,
                    259.37,
                    260.25,
                    261.05,
                    259.96,
                    258.21,
                    255.53,
                    246.7,
                    247.65,
                    248.35,
                    248.04,
                    255.41,
                    258.27,
                    256.44,
                    258.28,
                    259.48,
                    270.01,
                    269.48,
                    276.49,
                    275.91,
                    278.12,
                    274.62,
                    273.68,
                    275.5,
                    261.73,
                    255.78,
                    263.88,
                    264.35,
                    260.58,
                    264.58,
                    266.18,
                    272.14,
                    274.23,
                    272.95
                ],
                "volumes": [
                    49155614,
                    44664118,
                    31955776,
                    36496895,
                    38322012,
                    61999098,
                    38142942,
                    35477986,
                    33893611,
                    39776974,
                    49146961,
                    90483029,
                    46695948,
                    45015254,
                    32754941,
                    38253717,
                    44888152,
                    41534759,
                    51086742,
                    69886534,
                    86167123,
                    50194583,
                    49274846,
                    42586288,
                    51204045,
                    48227365,
                    41312412,
                    46208318,
                    48397982,
                    49602794,
                    47431331,
                    45018260,
                    45677278,
                    40424492,
                    45823568,
                    59030832,
                    65585796,
                    46914220,
                    33431423,
                    20135620,
                    46587722,
                    53669532,
                    43538687,
                    43989056,
                    47265845,
                    36406317,
                    31753410,
                    33038318,
                    33247986,
                    39532887,
                    50409078,
                    37648628,
                    50138743,
                    51630721,
                    144632048,
                    36571827,
                    29641999,
                    17910574,
                    21521802,
                    23715213,
                    22139617,
                    27293639,
                    37838054,
                    45647190,
                    52352090,
                    48309804,
                    50419337,
                    39996967,
                    45263767,
                    45730847,
                    40019421,
                    45263767,
                    72142773,
                    77280987,
                    54641725,
                    39708340,
                    41688982,
                    55969234,
                    48787855,
                    41287971,
                    67253009,
                    92443408,
                    73913425,
                    63799388,
                    90545710,
                    52977441,
                    50453414,
                    44623396,
                    34376898,
                    51931283,
                    81077229,
                    56290673,
                    58469094,
                    34203337,
                    30845294,
                    42070499,
                    37308155,
                    47014619,
                    33714342,
                    32096062
                ],
                "ma5": [
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    256.658,
                    254.108,
                    252.302,
                    250.56,
                    248.81599999999997,
                    247.498,
                    248.902,
                    251.81799999999998,
                    254.81799999999998,
                    256.64,
                    259.066,
                    261.172,
                    262.486,
                    263.732,
                    265.98199999999997,
                    268.346,
                    269.85599999999994,
                    269.904,
                    270.11199999999997,
                    270.2,
                    269.87399999999997,
                    269.494,
                    269.57,
                    270.61199999999997,
                    271.278,
                    271.914,
                    272.702,
                    272.308,
                    270.746,
                    269.764,
                    268.424,
                    268.23999999999995,
                    269.93199999999996,
                    271.838,
                    273.6360000000001,
                    276.15600000000006,
                    278.47799999999995,
                    280.53200000000004,
                    281.968,
                    282.59799999999996,
                    282.584,
                    281.54200000000003,
                    279.74,
                    278.666,
                    278.132,
                    278.03200000000004,
                    277.27599999999995,
                    276.762,
                    275.37399999999997,
                    274.206,
                    273.284,
                    272.65600000000006,
                    272.206,
                    272.6,
                    272.842,
                    272.86,
                    273.282,
                    273.18199999999996,
                    272.622,
                    271.39399999999995,
                    269.114,
                    266.56399999999996,
                    264.0,
                    261.67199999999997,
                    260.27,
                    260.008,
                    259.934,
                    259.76800000000003,
                    259.0,
                    256.29,
                    253.60999999999999,
                    251.288,
                    249.254,
                    249.22999999999996,
                    251.544,
                    253.302,
                    255.288,
                    257.576,
                    260.496,
                    262.738,
                    266.748,
                    270.274,
                    274.002,
                    274.924,
                    275.764,
                    275.566,
                    272.73,
                    268.262,
                    266.11400000000003,
                    264.24800000000005,
                    261.264,
                    261.834,
                    263.91400000000004,
                    265.566,
                    267.54200000000003,
                    270.01599999999996
                ],
                "ma20": [
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    257.892,
                    258.5095,
                    259.1275,
                    259.80550000000005,
                    260.4095,
                    261.196,
                    262.356,
                    263.44449999999995,
                    264.8185,
                    266.025,
                    267.3,
                    268.306,
                    268.56699999999995,
                    268.8005,
                    269.306,
                    269.6395,
                    270.073,
                    270.42850000000004,
                    270.827,
                    271.21950000000004,
                    271.592,
                    272.2285,
                    273.0855,
                    273.791,
                    274.319,
                    274.7695,
                    275.2405,
                    275.62800000000004,
                    275.8045,
                    276.03249999999997,
                    276.29900000000004,
                    276.384,
                    276.7415,
                    276.9615,
                    277.14300000000003,
                    277.514,
                    277.48799999999994,
                    277.31,
                    277.152,
                    276.9445,
                    276.68999999999994,
                    276.189,
                    275.47249999999997,
                    274.81550000000004,
                    274.1435,
                    273.3225,
                    272.4445,
                    271.5375,
                    270.567,
                    269.678,
                    268.8165,
                    268.10900000000004,
                    267.28900000000004,
                    266.4735,
                    265.19899999999996,
                    263.898,
                    262.767,
                    261.551,
                    260.631,
                    259.8745,
                    259.0085,
                    258.2685,
                    257.6495,
                    257.5995,
                    257.7105,
                    258.41700000000003,
                    259.196,
                    260.15,
                    260.9125,
                    261.584,
                    262.3065,
                    262.395,
                    262.27349999999996,
                    262.691,
                    263.5735,
                    264.21999999999997,
                    265.0315,
                    265.93850000000003,
                    266.775,
                    267.573,
                    268.3985
                ],
                "volumeChanges": [
                    true,
                    false,
                    false,
                    true,
                    false,
                    false,
                    false,
                    true,
                    false,
                    false,
                    true,
                    true,
                    true,
                    false,
                    false,
                    true,
                    true,
                    true,
                    true,
                    false,
                    false,
                    false,
                    true,
                    true,
                    true,
                    false,
                    true,
                    true,
                    false,
                    false,
                    true,
                    false,
                    false,
                    true,
                    false,
                    true,
                    true,
                    true,
                    true,
                    true,
                    true,
                    true,
                    false,
                    false,
                    false,
                    false,
                    false,
                    true,
                    false,
                    true,
                    false,
                    true,
                    false,
                    false,
                    true,
                    false,
                    true,
                    true,
                    false,
                    true,
                    true,
                    false,
                    false,
                    false,
                    false,
                    false,
                    true,
                    true,
                    true,
                    true,
                    true,
                    false,
                    false,
                    false,
                    false,
                    false,
                    true,
                    true,
                    false,
                    false,
                    true,
                    true,
                    true,
                    true,
                    true,
                    false,
                    true,
                    false,
                    false,
                    true,
                    false,
                    false,
                    true,
                    true,
                    false,
                    true,
                    true,
                    true,
                    true,
                    false
                ]
            }
        };

        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–å›¾è¡¨
        document.addEventListener('DOMContentLoaded', function() {
            try {
                // å¡«å……æŒ‡æ ‡å¡
                document.getElementById('total-days').textContent = metrics.total_days;
                document.getElementById('date-range').textContent = `${metrics.date_range_start} è‡³ ${metrics.date_range_end}`;
                document.getElementById('ytd-return').textContent = `+${metrics.ytd_return}%`;
                document.getElementById('avg-volume').textContent = metrics.avg_volume.toLocaleString();
                document.getElementById('max-price').textContent = `$${metrics.max_price}`;
                document.getElementById('min-price').textContent = `$${metrics.min_price}`;
                document.getElementById('avg-daily-range').textContent = `${metrics.avg_daily_range}%`;
                document.getElementById('up-down-days').textContent = `${metrics.up_days}â†‘ / ${metrics.down_days}â†“`;

                document.getElementById('overall-trend').textContent = metrics.trend;
                document.getElementById('first-close').textContent = `$${metrics.chart_data.closes[0].toFixed(2)}`;
                document.getElementById('last-close').textContent = `$${metrics.chart_data.closes[metrics.chart_data.closes.length - 1].toFixed(2)}`;
                document.getElementById('total-change').textContent = `${metrics.ytd_return >= 0 ? '+' : ''}${metrics.ytd_return}%`;
                document.getElementById('last10-change').textContent = `${metrics.last_10_return >= 0 ? '+' : ''}${metrics.last_10_return}%`;
                document.getElementById('first10-change').textContent = `${metrics.first_10_return >= 0 ? '+' : ''}${metrics.first_10_return}%`;
                document.getElementById('avg-volume-text').textContent = metrics.avg_volume.toLocaleString();

                // å¡«å……æˆäº¤é‡æœ€å¤§3ä¸ªäº¤æ˜“æ—¥è¡¨æ ¼
                const volumeTop3Body = document.getElementById('volume-top3');
                volumeTop3Body.innerHTML = '';
                metrics.volume_top3.forEach(row => {
                    const tr = document.createElement('tr');
                    tr.innerHTML = `
                        <td>${row.Date}</td>
                        <td>${row.Volume.toLocaleString()}</td>
                        <td class="${row.ChangePct >= 0 ? 'positive' : 'negative'}">${row.ChangePct.toFixed(2)}%</td>
                    `;
                    volumeTop3Body.appendChild(tr);
                });

                // å¡«å……æ”¯æ’‘ä½å’Œé˜»åŠ›ä½
                const supportLevels = document.getElementById('support-levels');
                const resistanceLevels = document.getElementById('resistance-levels');
                
                supportLevels.innerHTML = '';
                metrics.recent_lows.forEach(level => {
                    const li = document.createElement('li');
                    li.textContent = `$${level}`;
                    supportLevels.appendChild(li);
                });
                
                resistanceLevels.innerHTML = '';
                metrics.recent_highs.forEach(level => {
                    const li = document.createElement('li');
                    li.textContent = `$${level}`;
                    resistanceLevels.appendChild(li);
                });

                // åˆ›å»ºä»·æ ¼èµ°åŠ¿å›¾è¡¨
                const priceCtx = document.getElementById('priceChart').getContext('2d');
                const priceChart = new Chart(priceCtx, {
                    type: 'line',
                    data: {
                        labels: metrics.chart_data.dates,
                        datasets: [
                            {
                                label: 'AAPLæ”¶ç›˜ä»·',
                                data: metrics.chart_data.closes,
                                borderColor: '#3b82f6',
                                backgroundColor: 'rgba(59, 130, 246, 0.1)',
                                borderWidth: 2,
                                fill: true,
                                tension: 0.1
                            },
                            {
                                label: 'MA5',
                                data: metrics.chart_data.ma5.map((val, idx) => val > 0 ? val : null),
                                borderColor: '#10b981',
                                backgroundColor: 'transparent',
                                borderWidth: 2,
                                pointRadius: 0,
                                tension: 0.1
                            },
                            {
                                label: 'MA20',
                                data: metrics.chart_data.ma20.map((val, idx) => val > 0 ? val : null),
                                borderColor: '#f59e0b',
                                backgroundColor: 'transparent',
                                borderWidth: 2,
                                pointRadius: 0,
                                tension: 0.1
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            title: {
                                display: true,
                                text: 'AAPLè‚¡ä»·èµ°åŠ¿ (æ”¶ç›˜ä»· + MA5 + MA20)'
                            },
                            legend: {
                                display: true
                            }
                        },
                        scales: {
                            x: {
                                type: 'category',
                                title: {
                                    display: true,
                                    text: 'æ—¥æœŸ'
                                },
                                ticks: {
                                    maxTicksLimit: 10 // é™åˆ¶Xè½´æ ‡ç­¾æ•°é‡é¿å…è¿‡äºæ‹¥æŒ¤
                                }
                            },
                            y: {
                                title: {
                                    display: true,
                                    text: 'ä»·æ ¼ (USD)'
                                },
                                ticks: {
                                    callback: function(value) {
                                        return '$' + value.toFixed(2);
                                    }
                                }
                            }
                        }
                    }
                });

                // åˆ›å»ºæˆäº¤é‡æŸ±çŠ¶å›¾
                const volumeCtx = document.getElementById('volumeChart').getContext('2d');
                const volumeColors = metrics.chart_data.volumeChanges.map(isUp => isUp ? '#10b981' : '#ef4444');
                
                const volumeChart = new Chart(volumeCtx, {
                    type: 'bar',
                    data: {
                        labels: metrics.chart_data.dates,
                        datasets: [{
                            label: 'æˆäº¤é‡',
                            data: metrics.chart_data.volumes,
                            backgroundColor: volumeColors,
                            borderWidth: 0
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            title: {
                                display: true,
                                text: 'æ—¥æˆäº¤é‡ (ç»¿è‰²:ä¸Šæ¶¨æ—¥, çº¢è‰²:ä¸‹è·Œæ—¥)'
                            },
                            legend: {
                                display: true
                            }
                        },
                        scales: {
                            x: {
                                type: 'category',
                                title: {
                                    display: true,
                                    text: 'æ—¥æœŸ'
                                },
                                ticks: {
                                    maxTicksLimit: 10 // é™åˆ¶Xè½´æ ‡ç­¾æ•°é‡é¿å…è¿‡äºæ‹¥æŒ¤
                                }
                            },
                            y: {
                                title: {
                                    display: true,
                                    text: 'æˆäº¤é‡'
                                },
                                ticks: {
                                    callback: function(value) {
                                        return (value / 1000000).toFixed(0) + 'M';
                                    }
                                }
                            }
                        },
                        // æ·»åŠ ç‚¹å‡»äº‹ä»¶é¿å…å›¾è¡¨æ¸²æŸ“é—®é¢˜
                        onClick: (event, elements) => {
                            if(elements.length > 0) {
                                const datasetIndex = elements[0].datasetIndex;
                                const index = elements[0].index;
                                console.log(`Clicked on dataset ${datasetIndex}, index ${index}`);
                            }
                        }
                    }
                });

                // åˆ›å»ºæ”¶ç›˜ä»·åˆ†å¸ƒç›´æ–¹å›¾
                const closeHistogramCtx = document.getElementById('closeHistogram').getContext('2d');
                
                // å°†æ”¶ç›˜ä»·æŒ‰åŒºé—´åˆ†ç»„
                const priceMin = Math.min(...metrics.chart_data.closes);
                const priceMax = Math.max(...metrics.chart_data.closes);
                const binCount = 15;
                const binWidth = (priceMax - priceMin) / binCount;
                
                const bins = Array(binCount).fill(0);
                const binLabels = [];
                
                for (let i = 0; i < binCount; i++) {
                    const low = priceMin + i * binWidth;
                    const high = priceMin + (i + 1) * binWidth;
                    binLabels.push(`${low.toFixed(2)}-${high.toFixed(2)}`);
                    
                    for (const price of metrics.chart_data.closes) {
                        if (price >= low && price < high) {
                            bins[i]++;
                        }
                    }
                }
                
                // å¦‚æœæ˜¯æœ€åä¸€ä¸ªåŒºé—´ï¼Œä¹Ÿè¦åŒ…å«ç­‰äºä¸Šé™çš„æƒ…å†µ
                for (const price of metrics.chart_data.closes) {
                    if (price >= priceMax - binWidth && price <= priceMax) {
                        bins[binCount - 1]++;
                    }
                }
                
                const closeHistogram = new Chart(closeHistogramCtx, {
                    type: 'bar',
                    data: {
                        labels: binLabels,
                        datasets: [{
                            label: 'äº¤æ˜“æ—¥æ•°é‡',
                            data: bins,
                            backgroundColor: 'rgba(99, 102, 241, 0.6)',
                            borderColor: 'rgb(99, 102, 241)',
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            title: {
                                display: true,
                                text: 'æ”¶ç›˜ä»·åˆ†å¸ƒç›´æ–¹å›¾'
                            },
                            legend: {
                                display: true
                            }
                        },
                        scales: {
                            x: {
                                title: {
                                    display: true,
                                    text: 'ä»·æ ¼åŒºé—´ (USD)'
                                },
                                ticks: {
                                    maxRotation: 45
                                }
                            },
                            y: {
                                title: {
                                    display: true,
                                    text: 'å‡ºç°å¤©æ•°'
                                },
                                beginAtZero: true,
                                ticks: {
                                    stepSize: 1
                                }
                            }
                        }
                    }
                });

                // åˆ›å»ºæ—¥å†…æŒ¯å¹…æŠ˜çº¿å›¾
                const rangeChartCtx = document.getElementById('rangeChart').getContext('2d');

                // è®¡ç®—æ—¥å†…æŒ¯å¹…
                const intradayRanges = [];
                for (let i = 0; i < metrics.chart_data.highs.length; i++) {
                    intradayRanges.push(metrics.chart_data.highs[i] - metrics.chart_data.lows[i]);
                }

                // æ ‡è®°æ³¢åŠ¨è¾ƒå¤§çš„äº¤æ˜“æ—¥
                const rangeAnnotations = {
                    annotations: {}
                };

                metrics.high_range_days.forEach((day, idx) => {
                    const index = metrics.chart_data.dates.indexOf(day.Date);
                    if (index !== -1) {
                        rangeAnnotations.annotations[`point${idx}`] = {
                            type: 'point',
                            x: index,
                            y: intradayRanges[index],
                            backgroundColor: 'rgba(239, 68, 68, 0.8)',
                            radius: 6,
                            borderWidth: 2,
                            borderColor: '#ffffff',
                            label: {
                                content: `æŒ¯å¹…: $${day.IntradayRange.toFixed(2)}`,
                                display: true,
                                position: 'top'
                            }
                        };
                    }
                });

                const rangeChart = new Chart(rangeChartCtx, {
                    type: 'line',
                    data: {
                        labels: metrics.chart_data.dates,
                        datasets: [{
                            label: 'æ—¥å†…æŒ¯å¹… (High - Low)',
                            data: intradayRanges,
                            borderColor: 'rgb(139, 92, 246)',
                            backgroundColor: 'rgba(139, 92, 246, 0.1)',
                            borderWidth: 2,
                            fill: true,
                            tension: 0.2
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            title: {
                                display: true,
                                text: 'æ—¥å†…æ³¢åŠ¨åˆ†æ (çº¢ç‚¹æ ‡æ³¨æ³¢åŠ¨è¾ƒå¤§äº¤æ˜“æ—¥)'
                            },
                            legend: {
                                display: true
                            },
                            annotation: rangeAnnotations
                        },
                        scales: {
                            x: {
                                type: 'category',
                                title: {
                                    display: true,
                                    text: 'æ—¥æœŸ'
                                },
                                ticks: {
                                    maxTicksLimit: 10 // é™åˆ¶Xè½´æ ‡ç­¾æ•°é‡é¿å…è¿‡äºæ‹¥æŒ¤
                                }
                            },
                            y: {
                                title: {
                                    display: true,
                                    text: 'æŒ¯å¹… (USD)'
                                },
                                ticks: {
                                    callback: function(value) {
                                        return '$' + value.toFixed(2);
                                    }
                                }
                            }
                        }
                    }
                });
                
                console.log("æ‰€æœ‰å›¾è¡¨å·²æˆåŠŸåŠ è½½");
            } catch (error) {
                console.error("åˆå§‹åŒ–å›¾è¡¨æ—¶å‘ç”Ÿé”™è¯¯:", error);
            }
        });
    </script>
</body>
</html>